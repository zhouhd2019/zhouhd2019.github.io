---
layout:     post
title:      "Animation-Driven Locomotion with Locomotion Planning"
subtitle:   "GameAIPro Chapter25"
date:       2021-03-07  15:55:00
author:     "zhouhd"
header-img: "img/about-bg.jpg"
catalog: true
tags:
    - GameAI
    - GameAIPro
    - GameProgramming
---

## 概述
- 基于动画的运动可以提升角色真实感，需要对动画播放进行规划，使得每个动画都能适合当前和未来的动作和位移
- 根据移动的路径来逐步生成动画组成的路径。这些动画可以分成三种。移动动画用来完成大致是直线的长距离移动。移动前和移动后动画用来进入或者离开移动动画

## 运动规划
- 规划系统可以分为三个模块：导航路径处理器，管理动画栈的规划器，执行动画栈的动画系统
- 移动请求的处理从创建导航路径开始，记录下路径经过的多边形和拐点。记录多边形数据可以方便地进行平滑等处理，也便于小问题例如其它角色阻挡出现时，可以简单修改
- 动画规划从后往前规划，所以类似栈，但不需要从最后开始规划，可以从当前位置往后两三段路径或者一定距离开始，这样可以减少路径动态变化后的计算浪费，也可以减少全部计算带来的卡顿
- 动画规划一般有两种情况，一个动画可以完成，或者连续多个动画才能完成。单个动画一般用来完成一两步等特殊情况。
- 在多个动画的情况下，有时候需要处理一些没有合适动画的情况，例如要由蹲下到跑动，如果没有直接的过渡动画，就需要处理成先由蹲下到站起来，再由站过渡成跑动
- 每个动画需要记录下重要信息用于规划，包括位移信息，站姿信息，过渡信息
- 位移动画的播放需要注意以下几点：动作对齐，例如避免出现双脚交叉；播放速度修改；IK系统协同，例如等脚掌落地再继续播放动画

## 其它
- 所有计算应该支持分帧，并且支持优先级队列。导航路径计算优先级最低，静止角色的动画规划优先级排中间，移动中的角色动画规划优先级最高
- AI系统应该尽量减少请求的频率，否则角色可能反复播放开始和结束动画。进入位移和退出位移的