---
layout:     post
title:      "Paragon Bots: A Bag of Tricks"
subtitle:   "GameAIPro3 Chapter32"
date:       2021-07-16  11:48:00
author:     "zhouhd"
header-img: "img/about-bg.jpg"
catalog: true
tags:
    - GameAI
    - GameAIPro
    - GameAIPro3
    - GameProgramming
---

虚幻争霸AI主要基于UE4行为树和EQS，加上了MOBA游戏特有的空间表示方法和一些小技巧

## 高度参数化行为树
- 所有AI机器人用的是同一套行为树，主要是时间和人力限制。主行为树定义了通用结构，负责高级行为。具体行为的执行细节则高度参数化，不同AI机器人有不同的参数
- UE4行为树基于事件驱动，运行中的行为节点只能自己结束或者被其它节点打断。黑板是AI默认的信息存储位置，就是简单的键值对。节点会在黑板上获取和存储数据。键值变化也是事件，会影响节点运行
- EQS系统负责AI寻找位置和目标等任务，会将任务结果存放到行为树黑板。它也可以读取行为树的值来决定执行任务时的行为，例如为远程英雄寻找站位，会倾向于返回远离敌方英雄的位置

## 技能选择器和技能用途标记
- 特定情景该用哪个技能，是一个非常困难的问题
- 虚幻争霸的技能用UE4蓝图实现，易于自动解析并提取所需信息，标记该技能的用途。同时，策划也可以编辑技能用途标记
- 技能用途标记包括技能目标、范围、能耗、伤害、效果和机动性等等，AI决策用到的信息都需要记录下来
- 技能选择器用于针对特定目标在当前情境下，选择最有效的技能，基本上就是一个简单的遍历打分

## 影响图
- 简单来说就是抽象化的场景，每个单位都会产生影响，随着距离变远影响逐渐下降
- EQS可以使用影响图，辅助位置相关行为的决策，例如英雄想去安全的地方，就要参照影响图，远离敌方的影响
- 不同单位有不同的影响范围，不同的影响衰减。还有一些特殊情况，例如敌方防御塔如果已有小兵攻击目标，那么它的影响就很低，否则影响就非常高
- 对于防御塔和野怪等固定目标，影响往往也是固定的，可以保存影响结果，不需要每次重算
- 持续性AOE技能应该要考虑到影像图的计算，AI不应该走进这些区域。另外，AOE技能可以参考影响图来选择位置或者目标

## 前线信息
- 根据兵线和防御塔位置等等信息，可以得到前线位置。一般来说，双方的前线位置都是一样的
- EQS可以根据前线信息来辅助位置决策，例如让AI避免追击过深

## 其它
- AI准备放前摇长或者子弹速度慢的技能时，应该考虑到目标的移动速度，计算提前量
