---
layout:     post
title:      "Behavior Decision System: Dragon Age Inquisition's Utility Scoring Architecture"
subtitle:   "GameAIPro3 Chapter31"
date:       2021-07-13  11:31:00
author:     "zhouhd"
header-img: "img/about-bg.jpg"
catalog: true
tags:
    - GameAI
    - GameAIPro
    - GameAIPro3
    - GameProgramming
---

龙腾世纪：审判将效用AI应用到AI行为决策上，主要优点在于灵活和模块化

## 概览
- 龙腾世纪审判里面一个战斗单位一般有几十种技能，需要应对很多种情况
- 效用AI一般就是找出优先级最高的行为，核心问题有两个：如何找到并遍历所有行为，如何量化技能的优先级

## 实践
- 龙腾世纪审判拥有超过60种技能，但每种技能可能不止一种用法，例如冲锋可以用来冲到敌人旁边，也可以冲出敌人包围。因此，每种用法都应该单独拥有自己的评分
- 每种技能用法对应一个行为脚本，脚本包含它需要的信息或者访问这些信息的方法，并能够利用这些信息进行评分
- 行为脚本能够动态加载卸载，角色装备了新武器时应该同时加载武器的行为脚本(可能有多种)，玩家也可以用一些简单的命令来指示AI队友
- 龙腾世纪审判使用评价树进行对行为脚本的评分，简单来说就是一种流程图，有点像UE里面的蓝图，让策划方便编写一些简单的逻辑来完成评分
- 行为脚本可以分成多个类别，龙腾世纪审判对这些类别分别指定了基础优先级，例如特定场景反应评分从50到70，支援评分25到45，攻击20到40，这样可以便于理解和修改
- 行为一般需要一个或者多个目标，因此行为脚本除了返回评分，也应该拥有选择并返回目标的功能
- 得到最高评分的行为，接下来就是执行，每种行为有一个执行树，来负责具体的运行逻辑，执行树可以在多个行为之间共享，例如近战武器攻击行为一般都是走到目标身边并挥舞
- 为了减少AI角色的呆滞表现，一种行为正在运行，当它结束时应该负责保证发起新的评分。另外，所有行为的评分也应该持续进行，准备打断当前行为

## 其它
- 除了攻击和技能，跟随和巡逻等行为也可以放到AI行为决策这套框架上，一般放在优先级比较的基础行为类别上。另外，脱战撤退可以放在优先级最高的类别
- 类似行为的脚本可以共享，减少工作量
