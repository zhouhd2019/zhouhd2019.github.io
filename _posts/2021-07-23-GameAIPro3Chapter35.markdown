---
layout:     post
title:      "Ambient Interactions: Improving Believability by Leveraging Rule-Based AI"
subtitle:   "GameAIPro3 Chapter35"
date:       2021-07-23  11:10:00
author:     "zhouhd"
header-img: "img/about-bg.jpg"
catalog: true
tags:
    - GameAI
    - GameAIPro
    - GameAIPro3
    - GameProgramming
---

本章主要讲的是FF15怎么实现多NPC和环境交互。AI常用实现状态机和行为树一般用于个体，而FF15使用了一种以交互为中心的方法，通过STRIPS来描述交互地点的交互信息，适用于不同场景不同情况下的交互

## 概述
- 游戏The Sims模拟人生引入了智能物件的概念，可以交互的物件自行携带交互信息，包括交互动作等等。这种做法可以将交互信息和交互物件绑定，不需要将这些信息放到每个NPC的AI上，同时可以快速加入新物件
- 智能物件的想法后面发展成了智能区域，一个智能区域包括多个智能物件，可以进行多种不同的交互。除了物件本身信息，还需要它们之间的关系信息
- 智能区域通过带同步点的时间轴来驱动NPC
- FF15扩展智能物件为智能地点，管理属下的智能物件、相关交互脚本、当前脚本实例和交互NPC
- FF15的智能地点带有四种功能：通知功能，让NPC知道可以和它交互，一般用于AI比较复杂的角色，他们自行决定是否进行交互；脚本功能，交互最常见形式，基于周围NPC的数量和类型，给他们分配角色，开始执行交互脚本；生成功能，需要三四个NPC的交互一般很难发生，另外有些地方很难有NPC经过，生产功能负责创建新的NPC来满足需要；玩家相关功能，负责显示交互图标等等信息来吸引玩家参与交互

## 交互行为表示
- 本方法使用基于规则的脚本来表示交互行为，这种脚本的两个基础概念是STRIPS和元组空间
- STRIPS斯坦福研究所问题解算器，是一种规划系统。本方法的规则定义主要参照STRIPS，每种行为包括前提条件、正面效果和负面效果
- 元组空间一般用于分布式系统，这里将它简化，用于存储、查询和修改交互信息
- 交互脚本一般包含一组角色和一组规则，角色定义了可以参与交互的对象的种类和数量，规则定义了角色应该做什么
- 对于一次交互，每个对象只会有一个角色，但每次可能担任不同角色。角色定义包括名字、数量范围和标记
- 规则至少包括下列元素：前提条件，具体行为，行为参数，交互时正面和负面效果，交互结束正面和负面效果，结束脚本

## 执行交互
- 带有脚本功能的智能地点会定期查询周围NPC，尝试发起交互
- 成功发起交互后，第一步是分配角色，有些交互还支持动态加入，需要定时检查能否再加新角色；第二步执行规则
